<div class="projects-outer-wrapper">
  <section id="projects" class="projects-section">
    <div class="container">
    <div class="projects-header" data-aos="fade-up">
      <span class="section-label">{{ 'projects.headline' | translate }}</span>
      <h2 class="section-title">{{ 'projects.featured' | translate }}</h2>
      <p class="projects-description">
        {{ 'projects.description' | translate }}
      </p>
    </div>

    <div class="projects-wrapper">
      <!-- Table -->
      <table class="projects-table" data-aos="fade-right">
        <tbody>
          @for (project of projects; track $index) {
            <tr (mouseenter)="hoveredIndex = $index"
                (mouseleave)="hoveredIndex = -1"
                (click)="openProject(project, $index)"
                class="project-row">
              <td class="project-name">{{ project.nameKey }}</td>
              <td class="project-tech">
                @for (tech of project.tech; track $index) {
                  <span class="tech-name">{{ tech.tech }}</span>
                }
              </td>
            </tr>
          }
        </tbody>
      </table>

      <!-- Images -->
      <div class="images-container" data-aos="fade-left">
        @for (project of projects; track $index) {
          <div class="image-wrapper"
               [class.active]="hoveredIndex === $index"
               [style.top]="getImageTop($index)">
            <div class="image-shadow"></div>
            <img [src]="project.image" [alt]="project.nameKey" loading="lazy" />
          </div>
        }
      </div>
    </div>
    </div>
  </section>
</div>

<!-- Lightbox -->
@if (selectedProject) {
  <div class="lightbox-overlay" (click)="closeProject()">
    <div class="lightbox-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="closeProject()">Ã—</button>
      
      <div class="lightbox-left">
        <div class="lightbox-scroll-content">
          <h4>{{ formatProjectNumber(selectedIndex) }}</h4>
          <h2>{{ selectedProject.nameKey }}</h2>
          <h3>{{ 'projects.about' | translate }}</h3>
          <p>{{ selectedProject.descriptionKey | translate }}</p>

          <div class="tech-icons">
            @for (tech of selectedProject.tech; track $index) {
              <div class="tech-item">
                <img [src]="tech.image" [alt]="tech.tech" loading="lazy" />
                <p>{{ tech.tech }}</p>
              </div>
            }
          </div>
        </div>

        <div class="project-links">
          @if (selectedProject.github) {
            <a [href]="selectedProject.github" target="_blank">
              {{ 'projects.github' | translate }}
            </a>
          }
          @if (selectedProject.liveTest) {
            <a [href]="selectedProject.liveTest" target="_blank">
              {{ 'projects.liveTest' | translate }}
            </a>
          }
        </div>
      </div>

      <div class="lightbox-right">
        <div class="project-image">
          <img [src]="selectedProject.image" [alt]="selectedProject.nameKey" loading="lazy" />
        </div>
        <button class="next-btn" (click)="goToNextProject()">
          {{ 'projects.nextProject' | translate }}
        </button>
      </div>
    </div>
  </div>
}
